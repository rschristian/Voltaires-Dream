#Qahiri missions
#By ShyGuy13

vn_mam_missions_slot_1 = {
    slot = 6
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = MAM
            tag = FTM
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_mam_government_quarrels = {
        icon = mission_deccanis
        position = 1
        required_missions = {  }
        trigger = {
            stability = 2
            has_3_advisors_trigger = yes
        }
        effect = {
            add_country_modifier = {
                name = mam_government_quarrels_mission
                duration = 9125
            }
        }
    }
    vn_mam_debilitate_the_vizirate = {
        icon = mission_rule_the_garjats
        position = 3
        required_missions = { vn_mam_two_designations }
        trigger = {
            NOT = { corruption = 0.01 }
            if = {
                limit = { has_estate = estate_nobles }
                NOT = {
                    estate_influence = {
                        estate = estate_nobles
                        influence = 60
                    }
                }
            }
            if = {
                limit = { has_estate = estate_church }
                NOT = {
                    estate_influence = {
                        estate = estate_church
                        influence = 60
                    }
                }
            }
            if = {
                limit = { has_estate = estate_burghers }
                NOT = {
                    estate_influence = {
                        estate = estate_burghers
                        influence = 60
                    }
                }
            }
        }
        effect = {
            add_reform_progress_medium_effect = yes
            add_country_modifier = {
                name = mam_debilitate_the_vizirate_mission
                duration = 9125
            }
        }
    }
    vn_mam_modern_administration = {
        icon = mission_friends_or_enemies
        position = 4
        required_missions = { vn_mam_debilitate_the_vizirate }
        trigger = {
            if = {
                limit = { has_reform = fatimid_caliphate_reform }
                NOT = { has_disaster = great_fitna }
                NOT = { current_age = age_of_empire }
                NOT = { current_age = age_of_holy_wars }
            }
            stability = 3
            NOT = { average_autonomy = 40 }
        }
        effect = {
            if = {
                limit = { has_reform = fatimid_caliphate_reform }
                add_government_reform = feudal_theocracy
            }
            add_adm_power = 50
            add_country_modifier = {
                name = mam_modern_administration_mission
                duration = 9125
            }
        }
    }
    vn_mam_deploy_mercenaries = {
        icon = mission_new_army
        position = 5
        required_missions = {  }
        trigger = {
            num_of_mercenaries = 10
            land_maintenance = 1
            num_of_generals = 2
        }
        effect = {
            add_mil_power = 50
            add_country_modifier = {
                name = mam_deploy_mercenaries_mission
                duration = 9125
            }
        }
    }
    vn_mam_fight_the_mongols = {
        icon = mission_protect_granada
        position = 6
        required_missions = { vn_mam_deploy_mercenaries }
        trigger = {
            OR = {
				war_with = MGE
				war_with = ILK
				war_with = GLH
			}
        }
        effect = {
            country_event = { id = vn_missions.22 }
        }
    }
    vn_mam_conquer_tunis = {
        icon = mission_arabian_fort
        position = 7
		required_missions = { vn_mam_conquer_tripolitania }
		provinces_to_highlight = {
			OR = {
				area = tunis_area
				area = sousse_area
				area = kef_area
				area = kairouan_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            tunis_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			sousse_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			kef_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			kairouan_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            tlemcen_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            kabylia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            add_country_modifier = {
                name = mam_conquer_tunis_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_tlemcen = {
        icon = mission_conquer_algiers
        position = 9
		required_missions = { vn_mam_conquer_tunis }
		provinces_to_highlight = {
			OR = {
				region = tlemcen_region
				region = kabylia_region
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            tlemcen_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			kabylia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            sus_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            middle_atlas_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            add_country_modifier = {
                name = mam_conquer_tlemcen_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_north_morocco = {
        icon = mission_fortify_mandu
        position = 11
		required_missions = { vn_mam_conquer_tlemcen }
		provinces_to_highlight = {
			OR = {
                region = sus_region
                region = middle_atlas_region
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            sus_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			middle_atlas_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_years_of_income = 1
            andalusia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            alentejo_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            extremadura_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            toledan_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            high_atlas_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
			gharb_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
		    draa_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
			taroudant_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
			guelmim_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_mam_conquer_andalusia = {
        icon = mission_reclaim_andalucia
        position = 12
		required_missions = { vn_mam_conquer_north_morocco }
		provinces_to_highlight = {
			OR = {
                region = andalusia_region
                region = alentejo_region
                region = extremadura_region
                region = toledan_region
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            andalusia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			alentejo_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
            extremadura_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			toledan_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_adm_power = 100
            add_country_modifier = {
                name = mam_conquer_andalusia_mission
                duration = 9125
            }
        }
	}
}

vn_mam_missions_slot_2 = {
    slot = 7
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = MAM
            tag = FTM
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_mam_cultural_matters = {
        icon = mission_establish_the_black_guard
        position = 1
        required_missions = {  }
        trigger = {
            if = {
				limit = { has_estate = estate_dhimmi }
				estate_loyalty = {
					estate = estate_dhimmi
					loyalty = 60
                }
                num_of_estate_privileges = {
                    estate = estate_dhimmi
                    value = 2
                }
				num_of_estate_agendas_completed = {
                    estate = estate_dhimmi
                    value = 2
                } 
            }
            else = {
                NOT = { average_unrest = 2 }
                NOT = { num_of_rebel_armies = 1 }
                NOT = { num_of_rebel_controlled_provinces = 1 }
            }
        }
        effect = {
            add_country_modifier = {
                name = mam_cultural_matters_mission
                duration = 9125
            }
        }
    }
    vn_mam_two_designations = {
        icon = mission_fatimid_caliphate
        position = 2
        required_missions = { vn_mam_cultural_matters vn_mam_government_quarrels }
        trigger = {
            custom_trigger_tooltip = {
				tooltip = vn_mam_two_designations.tt
				NOT = { has_heir_flag = nizar_heir_flag }
				NOT = { has_ruler = "al-Mustansir" }
			}
            if = {
                limit = { has_dlc = "Common Sense" }
                legitimacy_equivalent = 100
            }
            else_if = {
                limit = { government = monarchy }
                legitimacy = 100
            }
			NOT = { num_of_rebel_armies = 1 }
			NOT = { num_of_rebel_controlled_provinces = 1 }
            months_of_ruling = 120
        }
        effect = {
            add_stability_or_adm_power = yes
            sirte_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            cyrenaica_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_mam_conquer_cyrene = {
        icon = mission_sea_battles
        position = 4
		required_missions = { vn_mam_two_designations }
		provinces_to_highlight = {
			OR = {
				area = sirte_area
				area = cyrenaica_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            sirte_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			cyrenaica_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            sirte_area = {
                add_devastation = -20
            }
            cyrenaica_area = {
                add_devastation = -20
            }
            tripolitania_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            djerba_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            mahdia_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            djerid_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_mam_conquer_tripolitania = {
        icon = mission_reconquer_ceuta
        position = 6
		required_missions = { vn_mam_conquer_cyrene }
		provinces_to_highlight = {
			OR = {
				area = tripolitania_area
				area = djerba_area
				area = mahdia_area
				area = djerid_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
			is_city = yes
		}
        trigger = {
            tripolitania_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			djerba_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			mahdia_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			djerid_area = {
				type = all
				OR = {
					is_city = no
					country_or_non_sovereign_subject_holds = ROOT
				}
			}
        }
        effect = {
            add_dip_power = 100
            tunis_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
			sousse_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
			kef_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
			kairouan_area = {
                limit = {
                    NOT = { is_core = ROOT }
                    NOT = { is_permanent_claim = ROOT }
                }
                add_permanent_claim = ROOT
            }
        }
    }
    vn_mam_create_a_navy = {
        icon = mission_combat_barbary_piracy
        position = 8
        required_missions = { vn_mam_conquer_lebanon vn_mam_conquer_tunis }
        trigger = {
			num_of_transport = 20
			naval_maintenance = 1
			num_of_admirals = 2
        }
        effect = {
            define_advisor = {
                type = naval_reformer
                skill = 3
                cost_multiplier = 0.25
            }
            sicilia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            cyprus_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            add_country_modifier = {
                name = mam_create_a_navy_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_sicily = {
        icon = mission_break_sicily
        position = 10
		required_missions = { vn_mam_create_a_navy }
		provinces_to_highlight = {
			region = sicilia_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            sicilia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_navy_tradition = 10
            apulia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            campania_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_mam_jihad_for_italy = {
        icon = mission_rule_italy
        position = 11
        required_missions = { vn_mam_conquer_sicily }
        provinces_to_highlight = {
			OR = {
				region = apulia_region
				region = campania_region
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            apulia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			campania_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_religious_influence_effect_large = yes
            add_country_modifier = {
                name = mam_jihad_for_italy_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_south_morocco = {
        icon = mission_new_world_power
        position = 12
		required_missions = { vn_mam_conquer_north_morocco }
		provinces_to_highlight = {
			OR = {
				region = high_atlas_region
				region = gharb_region
				area = draa_area
				area = taroudant_area
				area = guelmim_area
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
			is_city = yes
		}
        trigger = {
			high_atlas_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			gharb_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			draa_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			taroudant_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
            guelmim_area = {
				type = all
				OR = {
					is_city = no
					country_or_non_sovereign_subject_holds = ROOT
				}
			}
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 25 } 
            add_legitimacy = 15
        }
	}
}

vn_mam_missions_slot_3 = {
    slot = 8
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = MAM
            tag = FTM
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_mam_social_unity = {
        icon = mission_reliable_allies
        position = 1
        required_missions = {  }
        trigger = {
            religious_unity = 1
            num_accepted_cultures = 5
        }
        effect = {
            add_country_modifier = {
                name = mam_social_unity_mission
                duration = 9125
            }
        }
    }
    vn_mam_construct_madrasas = {
        icon = mission_sufi_shrines
        position = 2
        required_missions = { vn_mam_social_unity }
        trigger = {
            university = 20
        }
        effect = {
            reduce_innovativeness_big_effect = yes
            add_country_modifier = {
                name = mam_construct_madrasas_mission
                duration = 9125
            }
        }
    }
    vn_mam_improve_army_morale = {
        icon = mission_egyptian_mamluk_soldier
        position = 3
        required_missions = { vn_mam_two_designations }
        trigger = {
            land_maintenance = 1
            army_size_percentage = 0.75
            num_of_cavalry = 15
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 5 } 
            tabuk_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            add_country_modifier = {
                name = mam_improve_army_morale_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_hejaz = {
        icon = mission_unite_the_deccan
        position = 5
		required_missions = { vn_mam_improve_army_morale }
		provinces_to_highlight = {
			area = tabuk_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
			is_city = yes
		}
        trigger = {
            tabuk_area = {
				type = all
				OR = {
					is_city = no
					country_or_non_sovereign_subject_holds = ROOT
				}
			}
        }
        effect = {
            add_adm_power = 100
            add_prestige_or_monarch_power = { amount = 5 } 
            3026 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }
            }
            3027 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }
            }
            3028 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }
            }
            3029 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }
            }
            3030 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }
            }
            3031 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }
            }
            3108 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }	
            }
        }
    }
    vn_mam_conquer_lebanon = {
        icon = mission_unite_west_india
        position = 7
		required_missions = { vn_mam_conquer_hejaz }
		provinces_to_highlight = {
			OR = {
                province_id = 3026
                province_id = 3027
                province_id = 3028
                province_id = 3029
                province_id = 3030
                province_id = 3031
                province_id = 3108
            }
            NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            3026 = { country_or_non_sovereign_subject_holds = ROOT }
            3027 = { country_or_non_sovereign_subject_holds = ROOT }
            3028 = { country_or_non_sovereign_subject_holds = ROOT }
            3029 = { country_or_non_sovereign_subject_holds = ROOT }
            3030 = { country_or_non_sovereign_subject_holds = ROOT }
            3031 = { country_or_non_sovereign_subject_holds = ROOT }
            3108 = { country_or_non_sovereign_subject_holds = ROOT }
        }
        effect = {
            syria_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_mam_conquer_cyprus = {
        icon = mission_invade_island
        position = 9
		required_missions = { vn_mam_create_a_navy }
		provinces_to_highlight = {
			area = cyprus_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            cyprus_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            3076 = { add_base_production = 2 }
            crete_area = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
        }
    }
    vn_mam_conquer_crete = {
        icon = mission_restore_rule_over_mysore
        position = 11
		required_missions = { vn_mam_conquer_cyprus vn_mam_conquer_sicily }
		provinces_to_highlight = {
			area = crete_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            crete_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_country_modifier = {
                name = mam_conquer_crete_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_constantinople = {
        icon = mission_city_of_the_world's_desire
        position = 12
        required_missions = { vn_mam_conquer_crete vn_mam_conquer_phrygia }
        provinces_to_highlight = {
			OR = {
                region = thrakesion_region
                region = opsikion_region
                province_id = 2233
            }
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            thrakesion_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
            }
            opsikion_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
            }
            2233 = { country_or_non_sovereign_subject_holds = ROOT }
        }
        effect = {
            add_country_modifier = {
                name = mam_conquer_constantinople_mission
                duration = 9125
            }
            thrakesion_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
            }
            opsikion_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
            }
        }
    }
    vn_mam_supreme_caliphate = {
        icon = mission_muslim_warrior
        position = 13
        required_missions = { vn_mam_conquer_south_morocco vn_mam_conquer_constantinople vn_mam_conquer_baghdad vn_mam_conquer_andalusia }
        trigger = {
            if = {
				limit = { has_dlc = "Star and Crescent" }
				has_country_modifier = unified_islam
            }
            else = {
                religious_unity = 1
            }
            num_of_cities = 2500
        }
        effect = {
			add_adm_power = 100
			add_dip_power = 100
			add_mil_power = 100
            add_prestige_or_monarch_power = { amount = 25 } 
            add_legitimacy = 25
            add_country_modifier = {
                name = mam_supreme_caliphate_mission
                duration = -1
            }
        }
	}
}

vn_mam_missions_slot_4 = {
    slot = 9
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = MAM
            tag = FTM
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_mam_streets_and_canals = {
        icon = mission_merchant_of_gujarat
        position = 2
        required_missions = { vn_mam_develop_cairo }
        trigger = {
            OR = {
                temple = 10
                cathedral = 5
            }
            OR = {
                workshop = 10
                counting_house = 5
            }
        }
        effect = {
            add_country_modifier = {
                name = mam_streets_and_canals_mission
                duration = 9125
            }
        }
    }
    vn_mam_trade_with_india = {
        icon = mission_dharma_mission_arabian_trade
        position = 4
		required_missions = { vn_mam_streets_and_canals }
        trigger = {
            mercantilism = 35
            num_of_owned_provinces_with = {
                value = 3
                area = red_sea_coast_area
                OR = {
                    has_building = shipyard
                    has_building = grand_shipyard
                }
            }
            num_of_owned_provinces_with = {
                value = 3
                area = aqaba_area
                OR = {
                    has_building = shipyard
                    has_building = grand_shipyard
                }
            }
        }
        effect = {
            custom_tooltip = vn_mam_trade_with_india.tt
            hidden_effect = {
                random_owned_province = {
                    limit = {
                        OR = {
                            area = red_sea_coast_area
                            area = aqaba_area
                        }
                        OR = {
                            has_building = shipyard
                            has_building = grand_shipyard
                        }
                        NOT = { province_has_center_of_trade_of_level = 1 }
                    }
                    add_center_of_trade_level = 1
                }
            }
            red_sea_coast_area = {
                limit = { owned_by = ROOT }
                add_province_modifier = {
                    name = mam_trade_with_india_mission
                    duration = 9125
                }
            }
            aqaba_area = {
                limit = { owned_by = ROOT }
                add_province_modifier = {
                    name = mam_trade_with_india_mission
                    duration = 9125
                }
            }
        }
    }
    vn_mam_sessions_of_wisdom = {
        icon = mission_vedic_education
        position = 6
        required_missions = { vn_mam_conquer_hejaz }
        trigger = {
            is_defender_of_faith = yes
            if = {
                limit = { has_dlc = "Cradle of Civilization" }
                has_religious_scholars_trigger = yes
                calc_true_if = {
                    amount = 3
                    all_ally = {
                        NOT = { has_religious_school_of = ROOT }
                        has_opinion = {
                            who = ROOT
                            value = 150
                        }
                    }
                }
            }
            else = {
                num_of_allies = 5
                calc_true_if = {
                    amount = 3
                    all_ally = {
                        has_opinion = {
                            who = ROOT
                            value = 150
                        }
                    }
                }
            }
        }
        effect = {
            add_dip_power = 50
            add_country_modifier = {
                name = mam_sessions_of_wisdom_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_syria = {
        icon = mission_reclaim_lost_territory
        position = 8
		required_missions = { vn_mam_conquer_lebanon }
		provinces_to_highlight = {
			region = syria_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            syria_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_army_tradition = 15
            3111 = {
                add_base_manpower = 1
                add_province_modifier = {
                    name = mam_conquer_syria_mission
                    duration = -1
                }
            }
            cilicia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
        }
    }
    vn_mam_conquer_cilicia = {
        icon = mission_levantine_restoration
        position = 9
		required_missions = { vn_mam_conquer_syria }
		provinces_to_highlight = {
			region = cilicia_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            cilicia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            cappadokia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            charsianon_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            anatolikon_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
            add_country_modifier = {
                name = mam_conquer_cilicia_mission
                duration = 9125
            }
        }
    }
    vn_mam_conquer_cappadocia = {
        icon = mission_bengal_campaign
        position = 10
		required_missions = { vn_mam_conquer_cilicia }
		provinces_to_highlight = {
			OR = {
				region = cappadokia_region
				region = charsianon_region
				region = anatolikon_region
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            cappadokia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			charsianon_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			anatolikon_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            kibyrraioton_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            phrygia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            bukellarion_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            cappadokia_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
			}
			charsianon_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
			}
			anatolikon_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
			}
        }
    }
    vn_mam_conquer_phrygia = {
        icon = mission_soldiers_in_line
        position = 11
		required_missions = { vn_mam_conquer_cappadocia }
		provinces_to_highlight = {
			OR = {
				region = kibyrraioton_region
				region = phrygia_region
				region = bukellarion_region
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            kibyrraioton_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			phrygia_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
			bukellarion_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            thrakesion_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            opsikion_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
            }
            2233 = {
                if = {
                    limit = {
                        NOT = { owned_by = ROOT }
                        NOT = { is_permanent_claim = ROOT }
                    }
                    add_permanent_claim = ROOT	
                }
            }
            kibyrraioton_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
			}
			phrygia_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
			}
			bukellarion_region = {
				add_province_modifier = {
                    name = mam_conquer_cappadocia_mission
                    duration = 7300
                }
			}
        }
	}
}

vn_mam_missions_slot_5 = {
    slot = 10
    generic = no
    ai = yes
    potential = {
        OR = {
            tag = MAM
            tag = FTM
        }
        NOT = { map_setup = map_setup_random }
    }
    has_country_shield = yes

    vn_mam_develop_cairo = {
        icon = mission_imperial_cities
        position = 1
		required_missions = {  }
		provinces_to_highlight = {
			province_id = 5054
		}
        trigger = {
            5054 = {
				owned_by = ROOT
				development = 30
				has_fort_building_trigger = yes
			}
        }
        effect = {
            capital_scope = {
                add_base_tax = 1
                add_base_production = 1
                add_base_manpower = 1
                add_province_modifier = {
                    name = mam_develop_cairo_mission
                    duration = -1
                }
            }
        }
    }
    vn_mam_arabic_riches = {
        icon = mission_dominate_persian_gulf
        position = 2
		required_missions = { vn_mam_develop_cairo }
        trigger = {
           monthly_income = 100
           NOT = { num_of_loans = 1 }
           num_of_trading_bonuses = 10
        }
        effect = {
            add_country_modifier = {
                name = mam_arabic_riches_mission
                duration = 9125
            }
        }
    }
    vn_mam_develop_the_delta = {
        icon = mission_growth_of_surat
        position = 3
		required_missions = { vn_mam_arabic_riches }
		provinces_to_highlight = {
			OR = {
				province_id = 5030
				province_id = 5022
				province_id = 5047
			}
			OR = {
                NOT = { owned_by = ROOT }
                NOT = { base_production = 12 }
                has_manufactory_trigger = no
			}
		}
        trigger = {
            5030 = {
			    owned_by = ROOT
                base_production = 12
                has_manufactory_trigger = yes
			}
			5022 = {
				owned_by = ROOT
                base_production = 12
                has_manufactory_trigger = yes
			}
			5047 = {
				owned_by = ROOT
                base_production = 12
                has_manufactory_trigger = yes
            }
        }
        effect = {
            add_years_of_income = 0.5
            5030 = {
                add_province_modifier = {
                    name = mam_develop_the_delta
                    duration = 18250
                }
            }
            5022 = {
                add_province_modifier = {
                    name = mam_develop_the_delta
                    duration = 18250
                }
            }
            5047 = {
                add_province_modifier = {
                    name = mam_develop_the_delta
                    duration = 18250
                }
            }
        }
    }
    vn_mam_trade_fleet = {
        icon = mission_sponsor_piracy
        position = 4
		required_missions = { vn_mam_develop_the_delta }
        trigger = {
			num_of_light_ship = 50
			light_ship_fraction = 0.3
        }
        effect = {
            create_admiral = {
                tradition = 75
            }
            add_country_modifier = {
                name = mam_trade_fleet_mission
                duration = 9125
            }
        }
    }
    vn_mam_construct_suez_canal = {
        icon = construct_the_kiel_canal
        position = 5
		required_missions = { vn_mam_trade_with_india vn_mam_trade_fleet }
		provinces_to_highlight = {
			OR = {
				province_id = 5075
				province_id = 5082
				province_id = 5052
            }
            OR = {
                NOT = { owned_by = ROOT }
                NOT = { is_core = ROOT }
            }
		}
        trigger = {
            owns_core_province = 5075
            owns_core_province = 5082
            owns_core_province = 5052
            5075 = {
                has_great_project = {
					type = suez_canal
					tier = 3
				}
            }
        }
        effect = {
			add_mercantilism = 5
            5075 = {
                add_base_production = 3
            }
            5082 = {
                add_base_production = 3
            }
            5052 = {
                add_base_production = 3
            }
        }
    }
    vn_mam_conquer_al_jazira = {
        icon = mission_conquer_malwa_mer
        position = 9
		required_missions = { vn_mam_conquer_syria }
		provinces_to_highlight = {
			region = al_jazira_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            al_jazira_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_power_projection = {
                type = mission_rewards_power_projection
                amount = 20
            }
            assyria_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
        }
    }
    vn_mam_conquer_assyria = {
        icon = mission_into_persia_1
        position = 11
		required_missions = { vn_mam_conquer_al_jazira }
		provinces_to_highlight = {
			region = assyria_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            assyria_region = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
        }
        effect = {
            add_estate_dhimmi_loyalty_effect = yes
            lower_mesopotamia_region = {
				limit = {
					NOT = { is_core = ROOT }
					NOT = { is_permanent_claim = ROOT }
				}
				add_permanent_claim = ROOT
			}
        }
    }
    vn_mam_conquer_baghdad = {
        icon = mission_conquer_rewakantha
        position = 12
        required_missions = { vn_mam_conquer_assyria }
        provinces_to_highlight = {
			region = lower_mesopotamia_region
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}
        trigger = {
            lower_mesopotamia_region = {
                type = all
				country_or_non_sovereign_subject_holds = ROOT
            }
        }
        effect = {
            add_prestige_or_monarch_power = { amount = 15 } 
            add_country_modifier = {
                name = mam_conquer_baghdad_mission
                duration = 9125
            }
        }
	}
}